<script>
    document.addEventListener('DOMContentLoaded', () => {
        const audioPlayer = document.getElementById('audio-player');
        const trackArtist = document.getElementById('track-artist');
        const trackTitle = document.getElementById('track-title');
        const trackCover = document.getElementById('track-cover');

        // Quitar mute del reproductor al cargar
        audioPlayer.muted = false;

        // Obtener metadatos del stream (simulado)
        async function fetchStreamMetadata() {
            // Cambiar por tu lógica real para extraer artista y título
            const streamMetadata = {
                artist: "Adele", // Simulación
                title: "Rolling in the Deep" // Simulación
            };

            // Buscar información en la API de iTunes
            const query = `${streamMetadata.artist} ${streamMetadata.title}`;
            const iTunesApiUrl = `https://itunes.apple.com/search?term=${encodeURIComponent(query)}&limit=1`;

            try {
                const response = await fetch(iTunesApiUrl);
                const data = await response.json();

                if (data.results && data.results.length > 0) {
                    const track = data.results[0];

                    // Actualizar información en la interfaz
                    trackArtist.textContent = track.artistName || streamMetadata.artist;
                    trackTitle.textContent = track.trackName || streamMetadata.title;
                    trackCover.src = track.artworkUrl100.replace("100x100", "300x300") || 'PLAYER FONDO.png';
                } else {
                    // Si no encuentra datos, usar valores predeterminados
                    trackArtist.textContent = streamMetadata.artist;
                    trackTitle.textContent = streamMetadata.title;
                    trackCover.src = 'PLAYER FONDO.png';
                }
            } catch (error) {
                console.error('Error al obtener datos de iTunes:', error);
                trackArtist.textContent = streamMetadata.artist;
                trackTitle.textContent = streamMetadata.title;
                trackCover.src = 'PLAYER FONDO.png';
            }
        }

        // Cargar metadatos de la canción
        fetchStreamMetadata();

        // Forzar reproducción automática
        audioPlayer.play().catch(error => {
            console.warn('Autoplay no permitido. El usuario debe interactuar con la página.', error);
        });
    });
</script>
